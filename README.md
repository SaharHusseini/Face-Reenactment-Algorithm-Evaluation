# A 3D-ASSISTED FRAMEWORK TO EVALUATE THE QUALITY OF HEAD MOTION REPLICATION BY REENACTMENT DEEPFAKE GENERATORS

To evaluate the generated frames of your face reenactment algorithm, please follow the instructions below:

## Dataset Access

1. Access the dataset required for evaluation using the provided [Google link](https://drive.google.com/drive/folders/1RnPOTsH3t3j8zVLaKbPu-YMJBhevV5J4?usp=sharing). This link will direct you to a folder containing the necessary files, including source images, driving videos, and ground-truth videos or images.

2. Download the dataset files to your local machine for evaluation.

## Input Format Selection

Choose the appropriate input format based on the requirements of your algorithm:

- If your algorithm accepts video inputs, you can utilize the driving videos provided in the dataset.
- If your algorithm accepts individual frames, you can utilize the corresponding frames from the dataset.

## Evaluation for Pitch Negative Rotation

To evaluate your method for pitchNegative rotation, follow these steps:

1. Use the file named "source.jpeg" as the source image for evaluation.

2. Utilize the driving videos located in the "3D_real_head_dataset/videos/driver" folder as input for your algorithm.

3. Save the frames generated by your algorithm for each video under a separate folder with the following naming convention: "pitchNegative_id212_reenacted_by_idXXX". Replace "XXX" with the appropriate video identifier.

4. For evaluation purposes, you can use the ground-truth images available in the folder "3D_real_head_dataset/images/ground_truth".

5. Use the provided evaluation scripts to compute different metric scores between the generated images and the ground truth:

   - Use the `compute_SSIM.ipynb` script to compute the Structural Similarity Index (SSIM).
   - Use the `compute_CSIM.ipynb` script to compute the Cosine Similarity (CSIM).
   - Use the `compute_AKD.ipynb` script to compute the Average Keypoint Distance (AKD).

   **Note:** To avoid conflicts, set up a separate environment for each evaluation script. Install the required libraries listed below for each script:
   - `compute_SSIM.ipynb` requires `scikit-image (skimage)`, `pandas`, `PIL`, and `OpenCV (cv2)`.
   - `compute_CSIM.ipynb` requires the `deepface` library.
   - `compute_AKD.ipynb` requires `pandas`, `OpenCV (cv2)`, and `MediaPipe`.

## Additional Information

Please consider the following additional information:

- The identity of the source image in the FaceScape dataset is 212. We use identities 122, 340, 344, and 359 to reenact the source frame.

- It is recommended to use a different environment for each evaluation script to avoid conflicts and ensure that the required libraries are available.


Example:

1. Start by using the video file "3D_real_head_dataset/videos/driver/pitchNegative_id122.mp4" as the driving video to reenact the source image "source.jpeg".
2. Save the generated frames in a folder named "DAGAN_results_3D_heads/pitchNegative_id212_reenacted_by_id122".
3. For evaluation, utilize the frames from the video in the folder "3D_real_head_dataset/images/ground_truth/pitchNegative_id212" as the ground truth to compare against your generated images.
